using CSV
using DataFrames
using GLMakie
using Statistics

# make DF from CSV
df = CSV.read("./22spring/test1-data.csv", DataFrame)

# make new dfs with specific data
speed = df[:, ["0-20s", "20-40s", "40-60s"]]
time = df[:, ["Forwards", "Backwards", "Not"]]
changes = df[:, "# Direction Changes"]

# calculate summary stats
# mean and std for each row/worm
indiv_means = mean.(eachrow(speed))
indiv_stds = std.(eachrow(speed))
# mean and std for time in each dir
time_means = mean.(eachcol(time))
time_stds = std.(eachcol(time))
# mean and std for dir changes
changes_means = [mean(changes)]
changes_stds = [std(changes)]

# hitogram of all speeds
fig1 = Figure(
)

ax1 = Axis(
    fig1[1,1],
    xlabel = "'Instantaneous' Speed (body bends/20s)",
    ylabel = "# of Occurances",
)

hist!(ax1, vec(Matrix(speed)))

save("test1-insthist.png", fig1)

# histogram of average speeds
fig2 = Figure(
)

ax2 = Axis(
    fig2[1,1],
    xlabel = "Average Speed (body bends/20s)",
    ylabel = "# of Occurances",
)

hist!(ax2, indiv_means)

save("test1-avghist.png", fig2)


# scatterplot
fig3 = Figure(
)

ax3 = Axis(
    fig3[1,1],
    xlabel = "Average Speed (body bends/20s)",
    ylabel = "SD Speed (body bends/20s)",
)

scatter!(ax3, indiv_means, indiv_stds)

save("test1-scatter.png", fig3)


# barplot of time spent moving

directions = [1,2,3]

fig4 = Figure(
)

ax4 = Axis(
    fig4[1,1],
    xlabel = "Direction of Movement",
    xticks = ([1,2,3],["Fowards","Backwards", "Not"]),
    ylabel = "Time Spent Moving (s)",
)

barplot!(ax4, directions, time_means)
errorbars!(directions, time_means, time_stds, whiskerwidth = 50)

save("test1-timebar.png", fig4)


# barplot of direction changes

strains = [1]

fig5 = Figure(
)

ax5 = Axis(
    fig5[1,1],
    xlabel = "Strains",
    xticks = ([1], ["MT"]),
    ylabel = "# Direction Changes",
)

barplot!(ax5, strains, changes_means)
errorbars!(strains, changes_means, changes_stds, whiskerwidth = 50)

save("test1-dirbar.png", fig5)


